<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£ng T√≠nh L∆∞∆°ng</title>
      <meta name="apple-mobile-web-app-capable" content="yes">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ƒê·ªãnh nghƒ©a font Inter */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .section-title {
            position: relative;
            padding-left: 1.5rem;
        }
        .section-title::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 8px;
            height: 80%;
            background-color: #3b82f6; /* Blue 500 */
            border-radius: 4px;
        }
        .input-group label {
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            color: #374151; /* gray-700 */
        }
        .result-value {
            font-weight: 700;
            color: #16a34a; /* green-600 */
        }
        .final-result {
            font-size: 1.5rem; /* text-2xl */
            color: #b91c1c; /* red-700 */
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <div class="max-w-3xl mx-auto bg-white shadow-2xl rounded-xl p-4 sm:p-6 lg:p-8">
        <h1 class="text-3xl font-extrabold text-center text-gray-800 mb-6 border-b-4 border-blue-500 pb-2">
            B·∫£ng T√≠nh L∆∞∆°ng HYOSUNG
        </h1>

        <div id="input-section" class="bg-blue-50 p-5 rounded-xl shadow-lg mb-8">
            <h2 class="text-xl font-bold section-title text-blue-800 mb-4">1. S·ªë Li·ªáu ƒê·∫ßu V√†o & M·ª©c L∆∞∆°ng</h2>
            <div class="grid grid-cols-2 gap-4">
                <div class="input-group">
                    <label for="luong_co_ban_input" class="text-blue-700 font-bold">L∆∞∆°ng C∆° B·∫£n</label>
                    <input type="number" id="luong_co_ban_input" value="0" min="0" 
                        autocomplete="off" 
                        onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                        class="w-full p-2 border border-blue-400 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150 bg-white">
                </div>
                <div class="input-group">
                    <label for="luong_tinh_tang_ca_input" class="text-blue-700 font-bold">L∆∞∆°ng T√≠nh TƒÉng Ca</label>
                    <input type="number" id="luong_tinh_tang_ca_input" value="0" min="0" 
                        autocomplete="off" 
                        onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                        class="w-full p-2 border border-blue-400 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150 bg-white">
                </div>
                <div class="input-group">
                    <label for="ngay_di_lam">S·ªë Ng√†y ƒêi L√†m</label>
                    <input type="number" id="ngay_di_lam" value="0" min="0" 
                        autocomplete="off" 
                        onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                        class="w-full p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                </div>
                <div class="input-group">
                    <label for="pc_chuyen_can_input">Chuy√™n C·∫ßn</label>
                    <input type="number" id="pc_chuyen_can_input" value="0" min="0" 
                        autocomplete="off" 
                        onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                        class="w-full p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                </div>
                <div class="input-group">
                    <label for="pc_trach_nhiem_input">Tr√°ch Nhi·ªám</label>
                    <input type="number" id="pc_trach_nhiem_input" value="0" min="0" 
                        autocomplete="off" 
                        onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                        class="w-full p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                </div>
                <div class="input-group">
                    <label for="pc_tham_nien_input" class="text-green-700 font-bold">Th√¢m Ni√™n</label>
                    <input type="number" id="pc_tham_nien_input" value="0" min="0" 
                        autocomplete="off" 
                        onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                        class="w-full p-2 border border-green-400 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-150 bg-white">
                </div>
                
                <div class="col-span-2 grid grid-cols-2 gap-4 mt-2 border-t pt-4 border-blue-200 p-4 rounded-lg bg-white shadow-inner">
                    <div class="flex flex-col space-y-4">
                        <div class="input-group">
                            <label for="cd_30">Gi·ªù Ca ƒê√™m 30%</label>
                            <input type="number" id="cd_30" value="0" min="0" 
                                autocomplete="off" 
                                onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                                class="w-full p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                        </div>
                        <div class="input-group">
                            <label for="cd_50">Gi·ªù Ca ƒê√™m 50%</label>
                            <input type="number" id="cd_50" value="0" min="0" 
                                autocomplete="off" 
                                onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                                class="w-full p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                        </div>
                        <div class="input-group">
                            <label for="cd_70">Gi·ªù Ca ƒê√™m 70%</label>
                            <input type="number" id="cd_70" value="0" min="0" 
                                autocomplete="off" 
                                onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                                class="w-full p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                        </div>
                        <div class="input-group">
                            <label for="cd_90">Gi·ªù Ca ƒê√™m 90%</label>
                            <input type="number" id="cd_90" value="0" min="0" 
                                autocomplete="off" 
                                onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                                class="w-full p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                        </div>
                    </div>

                    <div class="flex flex-col space-y-4">
                        <div class="input-group">
                            <label for="tc_thuong">Gi·ªù TƒÉng Ca Th∆∞·ªùng</label>
                            <input type="number" id="tc_thuong" value="0" min="0" 
                                autocomplete="off" 
                                onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                                class="w-full p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                        </div>
                        <div class="input-group">
                            <label for="tc_nghi">Gi·ªù TƒÉng Ca Ng√†y Ngh·ªâ</label>
                            <input type="number" id="tc_nghi" value="0" min="0" 
                                autocomplete="off" 
                                onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                                class="w-full p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                        </div>
                        <div class="input-group">
                            <label for="tc_le">Gi·ªù TƒÉng Ca Ng√†y L·ªÖ</label>
                            <input type="number" id="tc_le" value="0" min="0" 
                                autocomplete="off" 
                                onfocus="if (this.value=='0') this.value='';" onblur="if (this.value=='') this.value='0';"
                                class="w-full p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="preset-manager" class="bg-gray-100 p-5 rounded-xl shadow-lg mb-8 border-t-4 border-purple-500">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                <span class="mr-2">üë§</span> Qu·∫£n L√Ω Preset C√° Nh√¢n (C√≥ M·∫≠t Kh·∫©u)
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 pb-4 border-b border-gray-300">
                <div class="md:col-span-1">
                    <label for="preset_select" class="text-sm font-medium text-purple-700">Ch·ªçn Preset</label>
                    <select id="preset_select" 
                            class="w-full p-2 border border-purple-300 rounded-md bg-white focus:ring-purple-500 focus:border-purple-500 transition duration-150">
                        <option value="">-- Ch·ªçn Preset ƒë·ªÉ T·∫£i --</option>
                    </select>
                </div>
                
                <div class="md:col-span-1">
                    <label for="preset_password_load" class="text-sm font-medium text-purple-700">M·∫≠t kh·∫©u ƒë·ªÉ T·∫£i</label>
                    <input type="password" id="preset_password_load" placeholder="Nh·∫≠p m·∫≠t kh·∫©u"
                           class="w-full p-2 border border-purple-300 rounded-md focus:ring-purple-500 focus:border-purple-500 transition duration-150">
                </div>

                <div class="flex items-end">
                    <button id="load_preset_btn" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-md transition duration-150 shadow-md disabled:bg-gray-400" disabled>
                        T·∫£i Preset
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 border-t pt-4">
                <div class="md:col-span-1">
                    <label for="preset_name_input" class="text-sm font-medium text-green-700">T√™n Preset M·ªõi / C·∫≠p nh·∫≠t</label>
                    <input type="text" id="preset_name_input" placeholder="V√≠ d·ª•: L∆∞∆°ng th√°ng 10 - T√™n b·∫°n" 
                           class="w-full p-2 border border-green-300 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-150">
                </div>
                
                <div class="md:col-span-1">
                    <label for="preset_password_save" class="text-sm font-medium text-green-700">M·∫≠t kh·∫©u ƒë·ªÉ L∆∞u</label>
                    <input type="password" id="preset_password_save" placeholder="Nh·∫≠p m·∫≠t kh·∫©u"
                           class="w-full p-2 border border-green-300 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-150">
                </div>

                <div class="flex items-end space-x-2">
                    <button id="save_preset_btn" class="w-1/2 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md transition duration-150 shadow-md">
                        L∆∞u Preset
                    </button>
                    <button id="delete_preset_btn" class="w-1/2 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-md transition duration-150 shadow-md disabled:bg-red-300" disabled>
                        X√≥a Preset
                    </button>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
            <div class="p-6 bg-yellow-100 rounded-xl shadow-lg border-l-4 border-yellow-500">
                <p class="text-sm font-medium text-yellow-800">T·ªîNG THU NH·∫¨P</p>
                <p id="tong_thu_nhap" class="text-2xl font-extrabold text-yellow-700 mt-1">0 VNƒê</p>
            </div>
            <div class="p-6 bg-red-100 rounded-xl shadow-lg border-l-4 border-red-500">
                <p class="text-sm font-medium text-red-800">TH·ª∞C L√ÉNH</p>
                <p id="thuc_lanh" class="text-3xl font-extrabold final-result mt-1">0 VNƒê</p>
            </div>
        </div>


        <div class="border border-gray-300 rounded-xl overflow-hidden shadow-lg"> 

            <div class="bg-white p-5 border-b border-gray-200">
                <h2 id="toggle_ttcb" class="text-xl font-bold section-title text-gray-800 cursor-pointer flex justify-between items-center hover:bg-gray-50 p-2 -m-2 rounded-lg transition duration-150">
                    2. Th√¥ng Tin C∆° B·∫£n <span id="ttcb_arrow" class="transition-transform duration-300 transform rotate-0">‚ñº</span>
                </h2>
                <div id="content_ttcb" class="space-y-2 text-sm pt-4 hidden border-t mt-4">
                    <p>L∆∞∆°ng C∆° B·∫£n: <span id="display_luong_co_ban" class="font-bold text-blue-600">0 VNƒê</span></p>
                    <p>Ng√†y ƒêi L√†m Th·ª±c T·∫ø: <span id="display_ngay_lam" class="font-bold text-gray-700">0</span> ng√†y</p>
                    <p>Ti·ªÅn 1 Gi·ªù L√†m: <span id="tien_1_gio_lam" class="result-value">0 VNƒê</span></p>
                    <p>Ti·ªÅn 1 Ng√†y L√†m: <span id="tien_1_ngay_lam" class="result-value">0 VNƒê</span></p>
                    <p>S·ªë Gi·ªù L√†m Vi·ªác: <span id="so_gio_lam_viec" class="result-value">0</span> gi·ªù</p>
                    <p class="pt-2 border-t mt-2">L∆∞∆°ng Th·ª±c T·∫ø: <span id="luong_thuc_te" class="text-base font-bold text-green-700">0 VNƒê</span></p>
                </div>
            </div>

            <div class="bg-white p-5 border-b border-gray-200">
                <h2 id="toggle_tc" class="text-xl font-bold section-title text-gray-800 cursor-pointer flex justify-between items-center hover:bg-gray-50 p-2 -m-2 rounded-lg transition duration-150">
                    3. T√≠nh Gi·ªù TƒÉng Ca <span id="tc_arrow" class="transition-transform duration-300 transform rotate-0">‚ñº</span>
                </h2>
                
                <p class="pt-2 border-t mt-2 text-sm">
                    T·ªïng Gi·ªù TƒÉng Ca: <span id="tong_gio_tang_ca" class="text-base font-bold text-green-700">0 VNƒê</span>
                </p>

                <div id="content_tc" class="space-y-2 text-sm pt-4 hidden border-t mt-4">
                    <p>L∆∞∆°ng T√≠nh TƒÉng Ca: <span id="display_luong_tinh_tang_ca" class="font-bold text-blue-600">0 VNƒê</span></p>
                    <p>Ti·ªÅn 1 Gi·ªù TƒÉng Ca (Base): <span id="tien_1_gio_tc" class="result-value">0 VNƒê</span></p>
                    <p>TƒÉng Ca Th∆∞·ªùng (150%): <span id="tc_thuong_tien" class="result-value">0 VNƒê</span></p>
                    <p>TƒÉng Ca Ng√†y Ngh·ªâ (200%): <span id="tc_nghi_tien" class="result-value">0 VNƒê</span></p>
                    <p>TƒÉng Ca Ng√†y L·ªÖ (300%): <span id="tc_le_tien" class="result-value">0 VNƒê</span></p>
                    <p>Ti·ªÅn Ca ƒê√™m 30% (Ph·ª• c·∫•p): <span id="cd_30_tien" class="result-value">0 VNƒê</span></p>
                    <p>Ti·ªÅn Ca ƒê√™m 50% (Ph·ª• c·∫•p): <span id="cd_50_tien" class="result-value">0 VNƒê</span></p>
                    <p>Ti·ªÅn Ca ƒê√™m 70% (Ph·ª• c·∫•p): <span id="cd_70_tien" class="result-value">0 VNƒê</span></p>
                    <p>Ti·ªÅn Ca ƒê√™m 90% (Ph·ª• c·∫•p): <span id="cd_90_tien" class="result-value">0 VNƒê</span></p>
                </div>
            </div>

            <div class="bg-white p-5 border-b border-gray-200">
                <h2 id="toggle_pc" class="text-xl font-bold section-title text-gray-800 cursor-pointer flex justify-between items-center hover:bg-gray-50 p-2 -m-2 rounded-lg transition duration-150">
                    4. C√°c Kho·∫£n Ph·ª• C·∫•p <span id="pc_arrow" class="transition-transform duration-300 transform rotate-0">‚ñº</span>
                </h2>
                
                <p class="pt-2 border-t mt-2 text-sm">
                    T·ªïng C√°c Kho·∫£n Ph·ª• C·∫•p: <span id="tong_phu_cap" class="text-base font-bold text-green-700">0 VNƒê</span>
                </p>

                <div id="content_pc" class="space-y-2 text-sm pt-4 hidden border-t mt-4">
                    <p>Ph·ª• C·∫•p Tr√¨nh ƒê·ªô (5769.22 x Ng√†y): <span id="pc_trinh_do" class="result-value">0 VNƒê</span></p>
                    <p>Ph·ª• C·∫•p Tr√°ch Nhi·ªám (ƒê·∫ßu v√†o): <span id="pc_trach_nhiem_result" class="font-bold text-gray-700">0 VNƒê</span></p>
                    <p class="text-green-700 font-bold">Ph·ª• C·∫•p Th√¢m Ni√™n (ƒê·∫ßu v√†o): <span id="pc_tham_nien_result" class="font-bold text-green-700">0 VNƒê</span></p>
                    <p>Ph·ª• C·∫•p Chuy√™n C·∫ßn (ƒê·∫ßu v√†o): <span id="pc_chuyen_can_result" class="font-bold text-gray-700">0 VNƒê</span></p>
                    <p>H·ªó Tr·ª£ ƒêi L·∫°i (C·ªë ƒë·ªãnh): <span class="font-bold text-gray-700">250,000 VNƒê</span></p>
                    <p>Ti·ªÅn Th∆∞·ªüng (C·ªë ƒë·ªãnh): <span class="font-bold text-gray-700">50,000 VNƒê</span></p>
                </div>
            </div>

            <div class="bg-white p-5">
                <h2 id="toggle_kt" class="text-xl font-bold section-title text-gray-800 cursor-pointer flex justify-between items-center hover:bg-gray-50 p-2 -m-2 rounded-lg transition duration-150">
                    5. C√°c Kho·∫£n Kh·∫•u Tr·ª´ <span id="kt_arrow" class="transition-transform duration-300 transform rotate-0">‚ñº</span>
                </h2>
                
                <p class="pt-2 border-t mt-2 text-sm">
                    T·ªïng C√°c Kho·∫£n Kh·∫•u Tr·ª´: <span id="tong_khau_tru" class="text-base font-bold text-red-700">0 VNƒê</span>
                </p>
                
                <div id="content_kt" class="space-y-2 text-sm pt-4 hidden border-t mt-4">
                    <p class="text-sm italic text-gray-500 mb-3">T√≠nh tr√™n L∆∞∆°ng T√≠nh Gi·ªù TƒÉng Ca: <span id="display_kh_luong_bh" class="font-medium">0 VNƒê</span></p>
                    <p>B·∫£o Hi·ªÉm Y T·∫ø (1.5%): <span id="kh_bhyt" class="font-bold text-red-600">0 VNƒê</span></p>
                    <p>B·∫£o Hi·ªÉm Tai N·∫°n (1%): <span id="kh_bhtn" class="font-bold text-red-600">0 VNƒê</span></p>
                    <p>B·∫£o Hi·ªÉm X√£ H·ªôi (8%): <span id="kh_bhxh" class="font-bold text-red-600">0 VNƒê</span></p>
                    <p>Ph√≠ C√¥ng ƒêo√†n (C·ªë ƒë·ªãnh): <span class="font-bold text-red-600">49,600 VNƒê</span></p>
                    <p>Ti·ªÅn Ti·∫øt Ki·ªám (C·ªë ƒë·ªãnh): <span class="font-bold text-red-600">200,000 VNƒê</span></p>
                    <p>Ti·ªÅn T·ª´ Thi·ªán (C·ªë ƒë·ªãnh): <span class="font-bold text-red-600">8,000 VNƒê</span></p>
                </div>
            </div>
        </div>

    </div>

    <script>
        // H√†m ƒë·ªãnh d·∫°ng s·ªë sang ti·ªÅn t·ªá Vi·ªát Nam ƒê·ªìng
        const formatVND = (amount) => {
            if (typeof amount !== 'number' || isNaN(amount)) return '0 VNƒê';
            // S·ª≠ d·ª•ng Intl.NumberFormat ƒë·ªÉ ƒë·ªãnh d·∫°ng, l√†m tr√≤n ƒë·∫øn s·ªë nguy√™n
            return new Intl.NumberFormat('vi-VN', {
                style: 'currency',
                currency: 'VND',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(Math.round(amount));
        };

        // ----------------------------------------------------
        // C√ÅC H·∫∞NG S·ªê C·ªê ƒê·ªäNH (C·ªë ƒë·ªãnh h√≥a c√°c h·∫±ng s·ªë kh√¥ng c·∫ßn nh·∫≠p)
        // ----------------------------------------------------
        const NGAY_CHUAN = 26;
        const GIO_CHUAN_NGAY = 8;
        
        // 3. C√°c Kho·∫£n Ph·ª• C·∫•p C·ªë ƒê·ªãnh
        const PC_HE_SO_TRINH_DO = 5769.22; // Ph·ª• c·∫•p tr√¨nh ƒë·ªô (ti·ªÅn/ng√†y)
        const PC_HO_TRO_DI_LAI = 250000;
        const PC_TIEN_THUONG = 50000;

        // 4. C√°c Kho·∫£n Kh·∫•u Tr·ª´ C·ªë ƒê·ªãnh & T·ª∑ l·ªá
        const KH_BHYT_RATE = 0.015;
        const KH_BHTN_RATE = 0.01;
        const KH_BHXH_RATE = 0.08;
        const KH_PHI_CONG_DOAN = 49600;
        const KH_TIEN_TIET_KIEM = 200000;
        const KH_TIEN_TU_THIEN = 8000;

        // ----------------------------------------------------
        // H√ÄM T√çNH TO√ÅN L∆Ø∆†NG
        // ----------------------------------------------------

        function calculateSalary() {
            // 1. S·ªë Li·ªáu ƒê·∫ßu V√†o (Input)
            // L·∫•y gi√° tr·ªã t·ª´ input, n·∫øu r·ªóng th√¨ d√πng 0
            const luong_co_ban_input = parseFloat(document.getElementById('luong_co_ban_input').value) || 0;
            const luong_tinh_tang_ca_input = parseFloat(document.getElementById('luong_tinh_tang_ca_input').value) || 0;
            const ngay_di_lam = parseFloat(document.getElementById('ngay_di_lam').value) || 0;
            const pc_chuyen_can_input = parseFloat(document.getElementById('pc_chuyen_can_input').value) || 0;
            const pc_trach_nhiem_input = parseFloat(document.getElementById('pc_trach_nhiem_input').value) || 0; 
            const pc_tham_nien_input = parseFloat(document.getElementById('pc_tham_nien_input').value) || 0; 
            
            // TƒÉng ca v√† Ca ƒë√™m
            const tc_thuong = parseFloat(document.getElementById('tc_thuong').value) || 0;
            const tc_nghi = parseFloat(document.getElementById('tc_nghi').value) || 0;
            const tc_le = parseFloat(document.getElementById('tc_le').value) || 0;
            const cd_30 = parseFloat(document.getElementById('cd_30').value) || 0;
            const cd_50 = parseFloat(document.getElementById('cd_50').value) || 0;
            const cd_70 = parseFloat(document.getElementById('cd_70').value) || 0;
            const cd_90 = parseFloat(document.getElementById('cd_90').value) || 0;

            const LuongCoBan = luong_co_ban_input;
            const LuongTinhTangCa = luong_tinh_tang_ca_input;
            const NgayDiLamThucTe = Math.max(0, ngay_di_lam);


            // 2. Th√¥ng Tin C∆° B·∫£n
            document.getElementById('display_luong_co_ban').textContent = formatVND(LuongCoBan);
            document.getElementById('display_ngay_lam').textContent = NgayDiLamThucTe;

            const Tien1GioLam = LuongCoBan > 0 ? LuongCoBan / NGAY_CHUAN / GIO_CHUAN_NGAY : 0;
            document.getElementById('tien_1_gio_lam').textContent = formatVND(Tien1GioLam);

            const Tien1NgayLam = LuongCoBan > 0 ? LuongCoBan / NGAY_CHUAN : 0;
            document.getElementById('tien_1_ngay_lam').textContent = formatVND(Tien1NgayLam);

            const SoGioLamViec = NgayDiLamThucTe * GIO_CHUAN_NGAY;
            document.getElementById('so_gio_lam_viec').textContent = SoGioLamViec;

            const LuongThucTe = Tien1GioLam * SoGioLamViec;
            document.getElementById('luong_thuc_te').textContent = formatVND(LuongThucTe);


            // 3. T√≠nh Gi·ªù TƒÉng Ca
            document.getElementById('display_luong_tinh_tang_ca').textContent = formatVND(LuongTinhTangCa);

            const Tien1GioTangCaBase = LuongTinhTangCa > 0 ? LuongTinhTangCa / NGAY_CHUAN / GIO_CHUAN_NGAY : 0;
            document.getElementById('tien_1_gio_tc').textContent = formatVND(Tien1GioTangCaBase);

            // C√¥ng th·ª©c: Ti·ªÅn 1 Gi·ªù TƒÉng Ca * S·ªë Gi·ªù * H·ªá s·ªë
            const TangCaThuong = Tien1GioTangCaBase * tc_thuong * 1.5;
            const TangCaNgayNghi = Tien1GioTangCaBase * tc_nghi * 2.0;
            const TangCaNgayLe = Tien1GioTangCaBase * tc_le * 3.0;
            const CaDem30 = Tien1GioTangCaBase * cd_30 * 0.3;
            const CaDem50 = Tien1GioTangCaBase * cd_50 * 0.5;
            const CaDem70 = Tien1GioTangCaBase * cd_70 * 0.7;
            const CaDem90 = Tien1GioTangCaBase * cd_90 * 0.9;

            document.getElementById('tc_thuong_tien').textContent = formatVND(TangCaThuong);
            document.getElementById('tc_nghi_tien').textContent = formatVND(TangCaNgayNghi);
            document.getElementById('tc_le_tien').textContent = formatVND(TangCaNgayLe);
            document.getElementById('cd_30_tien').textContent = formatVND(CaDem30);
            document.getElementById('cd_50_tien').textContent = formatVND(CaDem50);
            document.getElementById('cd_70_tien').textContent = formatVND(CaDem70);
            document.getElementById('cd_90_tien').textContent = formatVND(CaDem90);

            const TongGioTangCa = TangCaThuong + TangCaNgayNghi + TangCaNgayLe + CaDem30 + CaDem50 + CaDem70 + CaDem90;
            document.getElementById('tong_gio_tang_ca').textContent = formatVND(TongGioTangCa);


            // 4. C√°c Kho·∫£n Ph·ª• C·∫•p
            const PhuCapTrinhDo = PC_HE_SO_TRINH_DO * NgayDiLamThucTe;
            document.getElementById('pc_trinh_do').textContent = formatVND(PhuCapTrinhDo);
            
            // L·∫•y c√°c ph·ª• c·∫•p t·ª´ input
            const PC_CHUYEN_CAN = pc_chuyen_can_input;
            const PC_TRACH_NHIEM = pc_trach_nhiem_input;
            const PC_THAM_NIEN = pc_tham_nien_input; 
            
            document.getElementById('pc_chuyen_can_result').textContent = formatVND(PC_CHUYEN_CAN);
            document.getElementById('pc_trach_nhiem_result').textContent = formatVND(PC_TRACH_NHIEM);
            document.getElementById('pc_tham_nien_result').textContent = formatVND(PC_THAM_NIEN);

            const TongPhuCap = PhuCapTrinhDo + PC_TRACH_NHIEM + PC_THAM_NIEN + PC_CHUYEN_CAN + PC_HO_TRO_DI_LAI + PC_TIEN_THUONG;
            document.getElementById('tong_phu_cap').textContent = formatVND(TongPhuCap);


            // 5. C√°c Kho·∫£n Kh·∫•u Tr·ª´
            const LuongTinhGiaTangCa = LuongTinhTangCa; // L∆∞∆°ng T√≠nh Gi·ªù TƒÉng Ca
            document.getElementById('display_kh_luong_bh').textContent = formatVND(LuongTinhGiaTangCa);

            const KH_BHYT = LuongTinhGiaTangCa * KH_BHYT_RATE;
            const KH_BHTN = LuongTinhGiaTangCa * KH_BHTN_RATE;
            const KH_BHXH = LuongTinhGiaTangCa * KH_BHXH_RATE;
            document.getElementById('kh_bhyt').textContent = formatVND(KH_BHYT);
            document.getElementById('kh_bhtn').textContent = formatVND(KH_BHTN);
            document.getElementById('kh_bhxh').textContent = formatVND(KH_BHXH);

            const TongKhauTru = KH_BHYT + KH_BHTN + KH_BHXH + KH_PHI_CONG_DOAN + KH_TIEN_TIET_KIEM + KH_TIEN_TU_THIEN;
            document.getElementById('tong_khau_tru').textContent = formatVND(TongKhauTru);


            // 6. T·ªïng Thu Nh·∫≠p
            const TongThuNhap = LuongThucTe + TongGioTangCa + TongPhuCap;
            document.getElementById('tong_thu_nhap').textContent = formatVND(TongThuNhap);


            // 7. Th·ª±c L√£nh
            const ThucLanh = TongThuNhap - TongKhauTru;
            document.getElementById('thuc_lanh').textContent = formatVND(ThucLanh);
        }

        // ----------------------------------------------------
        // C√ÅC H√ÄM M√É H√ìA B·∫¢O M·∫¨T
        // ----------------------------------------------------
        // H√†m m√£ h√≥a/gi·∫£i m√£ ƒë∆°n gi·∫£n b·∫±ng XOR, s·ª≠ d·ª•ng m·∫≠t kh·∫©u l√†m key
        function simpleXorEncryptDecrypt(data, key) {
            let result = '';
            for (let i = 0; i < data.length; i++) {
                // √Åp d·ª•ng XOR gi·ªØa m√£ k√Ω t·ª± c·ªßa data v√† m√£ k√Ω t·ª± c·ªßa key (l·∫∑p l·∫°i)
                result += String.fromCharCode(data.charCodeAt(i) ^ key.charCodeAt(i % key.length));
            }
            return result;
        }


        // ----------------------------------------------------
        // QU·∫¢N L√ù PRESET C√Å NH√ÇN (LOCAL STORAGE)
        // ----------------------------------------------------

        // L·∫•y t·∫•t c·∫£ c√°c input c·∫ßn l∆∞u
        const PRESET_INPUT_IDS = [
            'luong_co_ban_input', 'luong_tinh_tang_ca_input', 'ngay_di_lam', 
            'pc_chuyen_can_input', 'pc_trach_nhiem_input', 'pc_tham_nien_input',
            'tc_thuong', 'tc_nghi', 'tc_le', 'cd_30', 'cd_50', 'cd_70', 'cd_90'
        ];
        
        // Load danh s√°ch Preset t·ª´ LocalStorage
        function loadPresets() {
            const selectElement = document.getElementById('preset_select');
            const storedPresets = JSON.parse(localStorage.getItem('salaryPresets') || '{}');
            
            // X√≥a c√°c option c≈©
            selectElement.innerHTML = '<option value="">-- Ch·ªçn Preset ƒë·ªÉ T·∫£i --</option>';

            // Th√™m c√°c preset ƒë√£ l∆∞u
            for (const name in storedPresets) {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                selectElement.appendChild(option);
            }
            
            // C·∫≠p nh·∫≠t tr·∫°ng th√°i n√∫t
            updatePresetButtons();
        }

        // L∆∞u Preset hi·ªán t·∫°i
        function savePreset() {
            const nameInput = document.getElementById('preset_name_input');
            const passwordInput = document.getElementById('preset_password_save');
            let presetName = nameInput.value.trim();
            const password = passwordInput.value;

            if (!presetName) {
                alert("Vui l√≤ng nh·∫≠p T√™n Preset ƒë·ªÉ l∆∞u!");
                return;
            }
            if (!password) {
                alert("Vui l√≤ng nh·∫≠p M·∫≠t kh·∫©u ƒë·ªÉ b·∫£o v·ªá Preset!");
                return;
            }

            const storedPresets = JSON.parse(localStorage.getItem('salaryPresets') || '{}');
            const rawData = {};

            // 1. L·∫•y d·ªØ li·ªáu th√¥
            PRESET_INPUT_IDS.forEach(id => {
                rawData[id] = document.getElementById(id).value;
            });

            // 2. M√£ h√≥a d·ªØ li·ªáu b·∫±ng m·∫≠t kh·∫©u
            const rawDataString = JSON.stringify(rawData);
            const encryptedData = btoa(simpleXorEncryptDecrypt(rawDataString, password)); // M√£ h√≥a XOR sau ƒë√≥ Base64

            // 3. L∆∞u d·ªØ li·ªáu ƒë√£ m√£ h√≥a
            storedPresets[presetName] = { 
                data: encryptedData,
            };
            
            localStorage.setItem('salaryPresets', JSON.stringify(storedPresets));
            
            alert(`Preset "${presetName}" ƒë√£ ƒë∆∞·ª£c l∆∞u v√† M√É H√ìA th√†nh c√¥ng!`);
            
            // D·ªçn d·∫πp
            loadPresets();
            document.getElementById('preset_select').value = presetName;
            nameInput.value = '';
            passwordInput.value = ''; // X√≥a m·∫≠t kh·∫©u sau khi l∆∞u
            updatePresetButtons();
        }

        // T·∫£i d·ªØ li·ªáu t·ª´ Preset ƒë√£ ch·ªçn v√†o c√°c Input Field
        function loadPresetData() {
            const selectElement = document.getElementById('preset_select');
            const passwordInput = document.getElementById('preset_password_load');
            const presetName = selectElement.value;
            const password = passwordInput.value;

            if (!presetName) {
                alert("Vui l√≤ng ch·ªçn m·ªôt Preset ƒë·ªÉ t·∫£i!");
                return;
            }
            if (!password) {
                alert("Vui l√≤ng nh·∫≠p M·∫≠t kh·∫©u ƒë·ªÉ gi·∫£i m√£ Preset!");
                return;
            }

            const storedPresets = JSON.parse(localStorage.getItem('salaryPresets') || '{}');
            const presetEntry = storedPresets[presetName];

            if (presetEntry) {
                try {
                    // 1. Gi·∫£i m√£ Base64
                    const decodedData = atob(presetEntry.data); 
                    
                    // 2. Gi·∫£i m√£ XOR b·∫±ng m·∫≠t kh·∫©u
                    const decryptedDataString = simpleXorEncryptDecrypt(decodedData, password); 
                    
                    // 3. Ph√¢n t√≠ch c√∫ ph√°p JSON
                    const presetData = JSON.parse(decryptedDataString);
                    
                    // 4. ƒê·ªï d·ªØ li·ªáu v√†o c√°c Input
                    PRESET_INPUT_IDS.forEach(id => {
                        document.getElementById(id).value = String(presetData[id] || '0');
                    });

                    // 5. Ch·∫°y l·∫°i t√≠nh to√°n
                    calculateSalary();
                    alert(`Preset "${presetName}" ƒë√£ ƒë∆∞·ª£c GI·∫¢I M√É v√† t·∫£i th√†nh c√¥ng!`);
                    passwordInput.value = ''; // X√≥a m·∫≠t kh·∫©u sau khi t·∫£i

                } catch (e) {
                    // L·ªói x·∫£y ra n·∫øu m·∫≠t kh·∫©u sai ho·∫∑c d·ªØ li·ªáu b·ªã h·ªèng
                    console.error("L·ªói gi·∫£i m√£/t·∫£i Preset:", e);
                    alert("Gi·∫£i m√£ th·∫•t b·∫°i! Vui l√≤ng ki·ªÉm tra l·∫°i M·∫≠t kh·∫©u.");
                }

            } else {
                 alert("Kh√¥ng t√¨m th·∫•y Preset n√†y.");
            }
        }
        
        // X√≥a Preset ƒë√£ ch·ªçn
        function deletePreset() {
            const selectElement = document.getElementById('preset_select');
            const presetName = selectElement.value;
            
            if (!presetName) return;

            if (confirm(`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a Preset "${presetName}"?`)) {
                const storedPresets = JSON.parse(localStorage.getItem('salaryPresets') || '{}');
                delete storedPresets[presetName];
                localStorage.setItem('salaryPresets', JSON.stringify(storedPresets));
                
                alert(`Preset "${presetName}" ƒë√£ ƒë∆∞·ª£c x√≥a!`);
                loadPresets();
            }
        }

        // C·∫≠p nh·∫≠t tr·∫°ng th√°i n√∫t T·∫£i/X√≥a
        function updatePresetButtons() {
            const selectElement = document.getElementById('preset_select');
            const loadBtn = document.getElementById('load_preset_btn');
            const deleteBtn = document.getElementById('delete_preset_btn');
            const presetNameInput = document.getElementById('preset_name_input');
            
            const selectedName = selectElement.value;

            // K√≠ch ho·∫°t/V√¥ hi·ªáu h√≥a n√∫t T·∫£i/X√≥a
            const shouldBeActive = selectedName !== "";
            loadBtn.disabled = !shouldBeActive;
            deleteBtn.disabled = !shouldBeActive;
            
            // T·ª± ƒë·ªông ƒëi·ªÅn t√™n preset ƒë√£ ch·ªçn v√†o √¥ input n·∫øu mu·ªën c·∫≠p nh·∫≠t
            if (shouldBeActive) {
                presetNameInput.value = selectedName;
            } else {
                 // N·∫øu kh√¥ng ch·ªçn preset n√†o, ƒë·∫∑t l·∫°i √¥ input tr·ªëng ƒë·ªÉ ng∆∞·ªùi d√πng nh·∫≠p t√™n m·ªõi
                 presetNameInput.value = '';
            }
        }

        // ----------------------------------------------------
        // H√ÄM X·ª¨ L√ù COLLAPSIBLE (CH·∫æ ƒê·ªò THU NH·ªé)
        // ----------------------------------------------------
        function setupCollapsibles() {
            const toggles = [
                { id: 'toggle_ttcb', contentId: 'content_ttcb', arrowId: 'ttcb_arrow' },
                { id: 'toggle_tc', contentId: 'content_tc', arrowId: 'tc_arrow' },
                { id: 'toggle_pc', contentId: 'content_pc', arrowId: 'pc_arrow' },
                { id: 'toggle_kt', contentId: 'content_kt', arrowId: 'kt_arrow' },
            ];

            toggles.forEach(item => {
                const toggleEl = document.getElementById(item.id);
                const contentEl = document.getElementById(item.contentId);
                const arrowEl = document.getElementById(item.arrowId);

                if (toggleEl && contentEl) {
                    // M·∫∑c ƒë·ªãnh t·∫•t c·∫£ ƒë·ªÅu b·ªã ·∫©n
                    contentEl.classList.add('hidden'); 
                    if (arrowEl) {
                        arrowEl.textContent = '‚ñº'; // ƒê·∫∑t m≈©i t√™n ch·ªâ xu·ªëng
                        arrowEl.classList.remove('rotate-180');
                        arrowEl.classList.add('rotate-0');
                    }

                    toggleEl.addEventListener('click', () => {
                        const isHidden = contentEl.classList.contains('hidden');
                        
                        // Toggle visibility
                        contentEl.classList.toggle('hidden');

                        // Toggle arrow rotation
                        if (arrowEl) {
                            if (isHidden) {
                                arrowEl.classList.remove('rotate-0');
                                arrowEl.classList.add('rotate-180');
                                arrowEl.textContent = '‚ñ≤'; 
                            } else {
                                arrowEl.classList.remove('rotate-180');
                                arrowEl.classList.add('rotate-0');
                                arrowEl.textContent = '‚ñº';
                            }
                        }
                    });
                }
            });
        }


        // ----------------------------------------------------
        // KH·ªûI T·∫†O V√Ä S·ª∞ KI·ªÜN
        // ----------------------------------------------------
        window.onload = function() {
            // L·∫Øng nghe s·ª± ki·ªán thay ƒë·ªïi tr√™n t·∫•t c·∫£ c√°c tr∆∞·ªùng input
            const inputs = document.querySelectorAll('#input-section input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('input', calculateSalary);
            });
            
            // C√†i ƒë·∫∑t ch·∫ø ƒë·ªô thu nh·ªè
            setupCollapsibles();
            
            // S·ª∞ KI·ªÜN PRESET
            document.getElementById('save_preset_btn').addEventListener('click', savePreset);
            document.getElementById('load_preset_btn').addEventListener('click', loadPresetData);
            document.getElementById('delete_preset_btn').addEventListener('click', deletePreset);
            document.getElementById('preset_select').addEventListener('change', updatePresetButtons);

            // T·∫£i danh s√°ch preset khi trang ƒë∆∞·ª£c t·∫£i
            loadPresets(); 

            // Th·ª±c hi·ªán t√≠nh to√°n l·∫ßn ƒë·∫ßu v·ªõi gi√° tr·ªã m·∫∑c ƒë·ªãnh (0)
            calculateSalary();
        }

    </script>
</body>

</html>
