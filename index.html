<!DOCTYPE html>
<html lang="vi" class="transition-all duration-500">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Báº£ng TÃ­nh LÆ°Æ¡ng HYOSUNG</title>
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link rel="icon" href="https://i.ibb.co/TqKdtqPL/18143710-3-E23-4754-A7-BD-E56-F73-CC1-E8-E.jpg" type="image/jpg">
  <link rel="apple-touch-icon" href="https://i.ibb.co/TqKdtqPL/18143710-3-E23-4754-A7-BD-E56-F73-CC1-E8-E.jpg">

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f3f4f6;
      transition: background-color 0.5s, color 0.5s;
    }
    .dark body { background-color: #111827; color: #e5e7eb; }
    .dark .bg-white { background-color: #1f2937; color: #e5e7eb; }
    .dark .text-gray-800 { color: #f3f4f6; }
    .dark .text-blue-800 { color: #93c5fd; }
    .dark .shadow-2xl { box-shadow: 0 4px 20px rgba(0,0,0,0.6); }

    .section-title { position: relative; padding-left: 1rem; }
    .section-title::before {
      content: '';
      position: absolute; left: 0; top: 50%; transform: translateY(-50%);
      width: 6px; height: 70%;
      background-color: #3b82f6; border-radius: 4px;
    }
    .result-value { font-weight: 700; color: #16a34a; transition: all 0.3s; }
    .final-result { font-size: 1.5rem; color: #b91c1c; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-in-on-load { animation: fadeIn 0.8s ease-out forwards; }
    @keyframes resultUpdate {
      0% { transform: scale(1); opacity: 0.5; }
      50% { transform: scale(1.05); opacity: 1; }
      100% { transform: scale(1); }
    }
    .animate-update { animation: resultUpdate 0.4s ease-out; }
  </style>
</head>
<body class="p-4 sm:p-6 md:p-8 transition-all duration-500 bg-gray-50 dark:bg-gray-900 dark:text-gray-100">
  <div class="flex justify-between items-center max-w-3xl mx-auto mb-4">
    <h1 class="text-2xl font-bold text-blue-700 dark:text-blue-300">Báº£ng TÃ­nh LÆ°Æ¡ng HYOSUNG</h1>
    <button id="themeToggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:scale-105 transition" title="Chuyá»ƒn giao diá»‡n">
      ğŸŒ™
    </button>
  </div>
  <div class="max-w-3xl mx-auto mb-6">
    <p class="text-center">
      <a href="tinhgio.html"
         class="inline-block bg-pink-600 hover:bg-pink-700 active:scale-95 text-white font-bold py-2 px-4 rounded-lg shadow-lg transition duration-150">
        ğŸš€ Má»Ÿ CÃ´ng Cá»¥ TÃ­nh Lá»‹ch TrÃ¬nh Cháº¡y MÃ¡y
      </a>
    </p>
  </div>

  <div class="max-w-3xl mx-auto bg-white shadow-2xl rounded-xl p-4 sm:p-6 lg:p-8 fade-in-on-load dark:bg-gray-800">
    <h1 class="text-3xl font-extrabold text-center text-gray-800 dark:text-gray-100 mb-6 border-b-4 border-blue-500 pb-2">
      Báº£ng TÃ­nh LÆ°Æ¡ng HYOSUNG
    </h1>

    <!-- INPUT -->
    <div id="input-section" class="bg-blue-50 dark:bg-gray-700 p-5 rounded-xl shadow-lg mb-8 transition duration-300 hover:shadow-xl">
      <h2 class="text-xl font-bold section-title text-blue-800 dark:text-blue-300 mb-4">1. Sá»‘ Liá»‡u Äáº§u VÃ o & Má»©c LÆ°Æ¡ng</h2>
      <div class="grid grid-cols-2 gap-4">
        <template id="inputTemplate">
          <div class="input-group">
            <label></label>
            <input type="number" value="0" min="0"
                   autocomplete="off"
                   onfocus="if(this.value=='0') this.value='';"
                   onblur="if(this.value=='') this.value='0';"
                   class="w-full p-2 border border-blue-300 dark:border-gray-500 rounded-md focus:ring-2 focus:border-blue-500 transition duration-150 bg-white dark:bg-gray-900">
          </div>
        </template>

        <!-- CÃ¡c input thá»±c -->
        <div><label for="luong_co_ban_input" class="font-bold text-blue-700">LÆ°Æ¡ng CÆ¡ Báº£n</label><input type="number" id="luong_co_ban_input" value="0" class="w-full p-2 border border-blue-400 rounded-md"></div>
        <div><label for="luong_tinh_tang_ca_input" class="font-bold text-blue-700">LÆ°Æ¡ng TÃ­nh TÄƒng Ca</label><input type="number" id="luong_tinh_tang_ca_input" value="0" class="w-full p-2 border border-blue-400 rounded-md"></div>
        <div><label for="ngay_di_lam">Sá»‘ NgÃ y Äi LÃ m</label><input type="number" id="ngay_di_lam" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>
        <div><label for="pc_chuyen_can_input">ChuyÃªn Cáº§n</label><input type="number" id="pc_chuyen_can_input" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>
        <div><label for="pc_trach_nhiem_input">TrÃ¡ch Nhiá»‡m</label><input type="number" id="pc_trach_nhiem_input" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>
        <div><label for="pc_tham_nien_input">ThÃ¢m NiÃªn</label><input type="number" id="pc_tham_nien_input" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>
        <div><label for="pc_tay_nghe_input">Tay Nghá»</label><input type="number" id="pc_tay_nghe_input" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>

        <div class="col-span-2 grid grid-cols-2 gap-4 mt-2 border-t pt-4 border-blue-200 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-inner transition duration-300 hover:shadow-md">
          <div class="flex flex-col space-y-4">
            <div><label for="cd_30">Ca ÄÃªm 30%</label><input id="cd_30" type="number" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>
            <div><label for="cd_50">Ca ÄÃªm 50%</label><input id="cd_50" type="number" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>
            <div><label for="cd_70">Ca ÄÃªm 70%</label><input id="cd_70" type="number" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>
            <div><label for="cd_90">Ca ÄÃªm 90%</label><input id="cd_90" type="number" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>
          </div>
          <div class="flex flex-col space-y-4">
            <div><label for="tc_thuong">TÄƒng Ca ThÆ°á»ng</label><input id="tc_thuong" type="number" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>
            <div><label for="tc_nghi">TÄƒng Ca NgÃ y Nghá»‰</label><input id="tc_nghi" type="number" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>
            <div><label for="tc_le">TÄƒng Ca NgÃ y Lá»…</label><input id="tc_le" type="number" value="0" class="w-full p-2 border border-blue-300 rounded-md"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- PRESET -->
    <div id="preset-manager" class="bg-gray-100 dark:bg-gray-700 p-5 rounded-xl shadow-lg mb-8 border-t-4 border-purple-500">
      <h2 class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-4 flex items-center"><span class="mr-2">ğŸ‘¤</span>Quáº£n LÃ½ Preset CÃ¡ NhÃ¢n</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
        <div class="md:col-span-2">
          <label for="preset_select" class="text-sm font-medium text-purple-700 dark:text-purple-300">Chá»n Preset</label>
          <select id="preset_select" class="w-full p-2 border border-purple-300 rounded-md bg-white dark:bg-gray-900"></select>
        </div>
        <div class="flex items-end">
          <button id="load_preset_btn" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-md transition duration-150 disabled:bg-gray-400">Táº£i Preset</button>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 border-t pt-4">
        <div class="md:col-span-2">
          <label for="preset_name_input" class="text-sm font-medium text-green-700 dark:text-green-300">TÃªn Preset</label>
          <input type="text" id="preset_name_input" placeholder="VD: NghÄ©a Äáº¹p Trai" class="w-full p-2 border border-green-300 rounded-md bg-white dark:bg-gray-900">
        </div>
        <div class="flex items-end space-x-2">
          <button id="save_preset_btn" class="w-1/2 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md">LÆ°u</button>
          <button id="delete_preset_btn" class="w-1/2 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-md disabled:bg-red-300" disabled>XÃ³a</button>
        </div>
      </div>
    </div>

    <!-- Káº¾T QUáº¢ -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
      <div class="p-6 bg-yellow-100 dark:bg-yellow-900 rounded-xl shadow-lg border-l-4 border-yellow-500"><p class="text-sm font-medium text-yellow-800 dark:text-yellow-200">Tá»”NG THU NHáº¬P</p><p id="tong_thu_nhap" class="text-2xl font-extrabold text-yellow-700 mt-1 result-display">0 VNÄ</p></div>
      <div class="p-6 bg-red-100 dark:bg-red-900 rounded-xl shadow-lg border-l-4 border-red-500"><p class="text-sm font-medium text-red-800 dark:text-red-200">THá»°C LÃƒNH</p><p id="thuc_lanh" class="text-3xl font-extrabold final-result mt-1 result-display">0 VNÄ</p></div>
    </div>

    <!-- CÃC Má»¤C CHI TIáº¾T -->
    <div class="border border-gray-300 dark:border-gray-600 rounded-xl overflow-hidden shadow-lg">

      <div class="bg-white dark:bg-gray-800 p-5 border-b border-gray-200 dark:border-gray-700">
        <h2 id="toggle_ttcb" class="text-xl font-bold section-title text-gray-800 flex justify-between items-center cursor-pointer">2. ThÃ´ng Tin CÆ¡ Báº£n <span id="ttcb_arrow" class="text-blue-500">â–¼</span></h2>
        <div id="content_ttcb" class="hidden pt-4 space-y-2 text-sm">
          <p>LÆ°Æ¡ng CÆ¡ Báº£n: <span id="display_luong_co_ban" class="font-bold text-blue-600">0 VNÄ</span></p>
          <p>NgÃ y Äi LÃ m Thá»±c Táº¿: <span id="display_ngay_lam" class="font-bold">0</span> ngÃ y</p>
          <p>Tiá»n 1 Giá» LÃ m: <span id="tien_1_gio_lam" class="result-value">0 VNÄ</span></p>
          <p>Tiá»n 1 NgÃ y LÃ m: <span id="tien_1_ngay_lam" class="result-value">0 VNÄ</span></p>
          <p>Sá»‘ Giá» LÃ m Viá»‡c: <span id="so_gio_lam_viec" class="result-value">0</span> giá»</p>
          <p>LÆ°Æ¡ng Thá»±c Táº¿: <span id="luong_thuc_te" class="font-bold text-green-700">0 VNÄ</span></p>
        </div>
      </div>

      <div class="bg-white dark:bg-gray-800 p-5 border-b border-gray-200 dark:border-gray-700">
        <h2 id="toggle_tc" class="text-xl font-bold section-title text-gray-800 flex justify-between items-center cursor-pointer">3. TÃ­nh Giá» TÄƒng Ca <span id="tc_arrow" class="text-blue-500">â–¼</span></h2>
        <p class="pt-2 text-sm">Tá»•ng Giá» TÄƒng Ca: <span id="tong_gio_tang_ca" class="font-bold text-green-700">0 VNÄ</span></p>
        <div id="content_tc" class="hidden pt-4 space-y-2 text-sm">
          <p>LÆ°Æ¡ng TÃ­nh TÄƒng Ca: <span id="display_luong_tinh_tang_ca" class="font-bold text-blue-600">0 VNÄ</span></p>
          <p>Tiá»n 1 Giá» TÄƒng Ca: <span id="tien_1_gio_tc" class="result-value">0 VNÄ</span></p>
          <p>TÄƒng Ca ThÆ°á»ng (150%): <span id="tc_thuong_tien" class="result-value">0 VNÄ</span></p>
          <p>TÄƒng Ca NgÃ y Nghá»‰ (200%): <span id="tc_nghi_tien" class="result-value">0 VNÄ</span></p>
          <p>TÄƒng Ca NgÃ y Lá»… (300%): <span id="tc_le_tien" class="result-value">0 VNÄ</span></p>
          <p>Ca ÄÃªm 30%: <span id="cd_30_tien" class="result-value">0 VNÄ</span></p>
          <p>Ca ÄÃªm 50%: <span id="cd_50_tien" class="result-value">0 VNÄ</span></p>
          <p>Ca ÄÃªm 70%: <span id="cd_70_tien" class="result-value">0 VNÄ</span></p>
          <p>Ca ÄÃªm 90%: <span id="cd_90_tien" class="result-value">0 VNÄ</span></p>
        </div>
      </div>

      <div class="bg-white dark:bg-gray-800 p-5 border-b border-gray-200 dark:border-gray-700">
        <h2 id="toggle_pc" class="text-xl font-bold section-title text-gray-800 flex justify-between items-center cursor-pointer">4. CÃ¡c Khoáº£n Phá»¥ Cáº¥p <span id="pc_arrow" class="text-blue-500">â–¼</span></h2>
        <p class="pt-2 text-sm">Tá»•ng Phá»¥ Cáº¥p: <span id="tong_phu_cap" class="font-bold text-green-700">0 VNÄ</span></p>
        <div id="content_pc" class="hidden pt-4 space-y-2 text-sm">
          <p>Phá»¥ Cáº¥p Tay Nghá» (CÃ´ng Thá»©c): <span id="pc_trinh_do" class="result-value">0 VNÄ</span></p>
          <p>Phá»¥ Cáº¥p TrÃ¡ch Nhiá»‡m: <span id="pc_trach_nhiem_result">0 VNÄ</span></p>
          <p>Phá»¥ Cáº¥p ThÃ¢m NiÃªn: <span id="pc_tham_nien_result">0 VNÄ</span></p>
          <p>Phá»¥ Cáº¥p Tay Nghá» (Input): <span id="pc_tay_nghe_result">0 VNÄ</span></p>
          <p>Phá»¥ Cáº¥p ChuyÃªn Cáº§n: <span id="pc_chuyen_can_result">0 VNÄ</span></p>
          <p>Há»— Trá»£ Äi Láº¡i: <span>250,000 VNÄ</span></p>
          <p>Tiá»n ThÆ°á»Ÿng: <span>50,000 VNÄ</span></p>
        </div>
      </div>

      <div class="bg-white dark:bg-gray-800 p-5">
        <h2 id="toggle_kt" class="text-xl font-bold section-title text-gray-800 flex justify-between items-center cursor-pointer">5. CÃ¡c Khoáº£n Kháº¥u Trá»« <span id="kt_arrow" class="text-blue-500">â–¼</span></h2>
        <p class="pt-2 text-sm">Tá»•ng Kháº¥u Trá»«: <span id="tong_khau_tru" class="font-bold text-red-700">0 VNÄ</span></p>
        <div id="content_kt" class="hidden pt-4 space-y-2 text-sm">
          <p>BHYT (1.5%): <span id="kh_bhyt" class="text-red-600">0 VNÄ</span></p>
          <p>BHTN (1%): <span id="kh_bhtn" class="text-red-600">0 VNÄ</span></p>
          <p>BHXH (8%): <span id="kh_bhxh" class="text-red-600">0 VNÄ</span></p>
          <p>PhÃ­ CÃ´ng ÄoÃ n: 49,600 VNÄ</p>
          <p>Tiáº¿t Kiá»‡m: 200,000 VNÄ</p>
          <p>Tá»« Thiá»‡n: 8,000 VNÄ</p>
        </div>
      </div>
    </div>
  </div>
<script>
  const formatVND = v =>
    new Intl.NumberFormat('vi-VN', {
      style: 'currency',
      currency: 'VND',
      minimumFractionDigits: 0,
    }).format(Math.max(0, Math.round(v || 0)));

  const NGAY_CHUAN = 26, GIO_CHUAN_NGAY = 8;
  const PC_HE_SO_TRINH_DO = 5769.22;
  const PC_HO_TRO_DI_LAI = 250000, PC_TIEN_THUONG = 50000;
  const KH_BHYT_RATE = 0.015, KH_BHTN_RATE = 0.01, KH_BHXH_RATE = 0.08;
  const KH_PHI_CONG_DOAN = 49600, KH_TIEN_TIET_KIEM = 200000, KH_TIEN_TU_THIEN = 8000;

  const PRESET_KEYS = [
    'luong_co_ban_input', 'luong_tinh_tang_ca_input', 'ngay_di_lam',
    'pc_chuyen_can_input', 'pc_trach_nhiem_input', 'pc_tham_nien_input', 'pc_tay_nghe_input',
    'tc_thuong', 'tc_nghi', 'tc_le', 'cd_30', 'cd_50', 'cd_70', 'cd_90'
  ];

  let prevIncome = 0, prevNet = 0, debounceTimer;

  const triggerUpdate = id => {
    const el = document.getElementById(id);
    el.classList.remove('animate-update'); void el.offsetWidth;
    el.classList.add('animate-update');
  };

  function calcSalary() {
    const g = id => Math.max(0, parseFloat(document.getElementById(id).value) || 0);
    const LuongCoBan = g('luong_co_ban_input'),
          LuongTangCa = g('luong_tinh_tang_ca_input'),
          NgayDiLam = g('ngay_di_lam'),
          pcCC = g('pc_chuyen_can_input'),
          pcTNhiem = g('pc_trach_nhiem_input'),
          pcThamNien = g('pc_tham_nien_input'),
          pcTayNghe = g('pc_tay_nghe_input'),
          tcThuong = g('tc_thuong'), tcNghi = g('tc_nghi'), tcLe = g('tc_le'),
          cd30 = g('cd_30'), cd50 = g('cd_50'), cd70 = g('cd_70'), cd90 = g('cd_90');

    const tien1Ngay = LuongCoBan / NGAY_CHUAN;
    const tien1Gio = LuongCoBan / NGAY_CHUAN / GIO_CHUAN_NGAY;
    const soGio = NgayDiLam * GIO_CHUAN_NGAY;
    const luongThucTe = tien1Gio * soGio;

    document.getElementById('display_luong_co_ban').textContent = formatVND(LuongCoBan);
    document.getElementById('display_ngay_lam').textContent = NgayDiLam;
    document.getElementById('tien_1_gio_lam').textContent = formatVND(tien1Gio);
    document.getElementById('tien_1_ngay_lam').textContent = formatVND(tien1Ngay);
    document.getElementById('so_gio_lam_viec').textContent = soGio;
    document.getElementById('luong_thuc_te').textContent = formatVND(luongThucTe);

    const tien1GioTC = LuongTangCa / NGAY_CHUAN / GIO_CHUAN_NGAY;
    const tcThuongTien = tien1GioTC * tcThuong * 1.5;
    const tcNghiTien = tien1GioTC * tcNghi * 2;
    const tcLeTien = tien1GioTC * tcLe * 3;
    const cd30t = tien1GioTC * cd30 * 0.3;
    const cd50t = tien1GioTC * cd50 * 0.5;
    const cd70t = tien1GioTC * cd70 * 0.7;
    const cd90t = tien1GioTC * cd90 * 0.9;
    const tongTangCa = tcThuongTien + tcNghiTien + tcLeTien + cd30t + cd50t + cd70t + cd90t;

    ['tc_thuong_tien','tc_nghi_tien','tc_le_tien','cd_30_tien','cd_50_tien','cd_70_tien','cd_90_tien']
      .forEach((id,i)=>document.getElementById(id).textContent =
        formatVND([tcThuongTien,tcNghiTien,tcLeTien,cd30t,cd50t,cd70t,cd90t][i]));
    document.getElementById('tien_1_gio_tc').textContent = formatVND(tien1GioTC);
    document.getElementById('display_luong_tinh_tang_ca').textContent = formatVND(LuongTangCa);
    document.getElementById('tong_gio_tang_ca').textContent = formatVND(tongTangCa);

    const pcTayNgheAuto = PC_HE_SO_TRINH_DO * NgayDiLam;
    const tongPhuCap = pcTayNgheAuto + pcTNhiem + pcThamNien + pcTayNghe + pcCC + PC_HO_TRO_DI_LAI + PC_TIEN_THUONG;
    document.getElementById('pc_trinh_do').textContent = formatVND(pcTayNgheAuto);
    document.getElementById('pc_trach_nhiem_result').textContent = formatVND(pcTNhiem);
    document.getElementById('pc_tham_nien_result').textContent = formatVND(pcThamNien);
    document.getElementById('pc_tay_nghe_result').textContent = formatVND(pcTayNghe);
    document.getElementById('pc_chuyen_can_result').textContent = formatVND(pcCC);
    document.getElementById('tong_phu_cap').textContent = formatVND(tongPhuCap);

    const bhyt = LuongTangCa * KH_BHYT_RATE, bhtn = LuongTangCa * KH_BHTN_RATE, bhxh = LuongTangCa * KH_BHXH_RATE;
    const tongKhauTru = bhyt + bhtn + bhxh + KH_PHI_CONG_DOAN + KH_TIEN_TIET_KIEM + KH_TIEN_TU_THIEN;
    document.getElementById('kh_bhyt').textContent = formatVND(bhyt);
    document.getElementById('kh_bhtn').textContent = formatVND(bhtn);
    document.getElementById('kh_bhxh').textContent = formatVND(bhxh);
    document.getElementById('tong_khau_tru').textContent = formatVND(tongKhauTru);

    const tongThuNhap = luongThucTe + tongTangCa + tongPhuCap;
    const thucLanh = tongThuNhap - tongKhauTru;
    document.getElementById('tong_thu_nhap').textContent = formatVND(tongThuNhap);
    document.getElementById('thuc_lanh').textContent = formatVND(thucLanh);

    if (tongThuNhap !== prevIncome) triggerUpdate('tong_thu_nhap');
    if (thucLanh !== prevNet) triggerUpdate('thuc_lanh');
    prevIncome = tongThuNhap; prevNet = thucLanh;
  }

  function setupToggles() {
    [['toggle_ttcb','content_ttcb','ttcb_arrow'],
     ['toggle_tc','content_tc','tc_arrow'],
     ['toggle_pc','content_pc','pc_arrow'],
     ['toggle_kt','content_kt','kt_arrow']].forEach(([btn,content,arrow])=>{
      const b=document.getElementById(btn), c=document.getElementById(content), a=document.getElementById(arrow);
      b.addEventListener('click',()=>{
        const hide=c.classList.toggle('hidden');
        a.textContent=hide?'â–¼':'â–²';
      });
    });
  }

  function loadPresets() {
    const s=document.getElementById('preset_select');
    const data=JSON.parse(localStorage.getItem('salaryPresets')||'{}');
    s.innerHTML='<option value="">-- Chá»n Preset --</option>';
    for(const k in data){const o=document.createElement('option');o.value=o.textContent=k;s.appendChild(o);}
  }

  function savePreset() {
    const name=document.getElementById('preset_name_input').value.trim();
    if(!name){alert('Nháº­p tÃªn preset!');return;}
    const store=JSON.parse(localStorage.getItem('salaryPresets')||'{}');
    const data={}; PRESET_KEYS.forEach(id=>data[id]=document.getElementById(id).value);
    store[name]=data; localStorage.setItem('salaryPresets',JSON.stringify(store));
    alert(`Preset "${name}" Ä‘Ã£ lÆ°u!`); loadPresets();
  }

  function loadPresetData() {
    const name=document.getElementById('preset_select').value;
    if(!name){alert('Chá»n preset!');return;}
    const store=JSON.parse(localStorage.getItem('salaryPresets')||'{}');
    const data=store[name]; if(!data)return;
    PRESET_KEYS.forEach(id=>document.getElementById(id).value=data[id]||0);
    calcSalary(); alert(`ÄÃ£ táº£i preset "${name}"`);
  }

  function deletePreset() {
    const name=document.getElementById('preset_select').value;
    if(!name)return;
    if(confirm(`XÃ³a preset "${name}"?`)){
      const store=JSON.parse(localStorage.getItem('salaryPresets')||'{}');
      delete store[name]; localStorage.setItem('salaryPresets',JSON.stringify(store));
      loadPresets();
    }
  }

  function setupTheme() {
    const root=document.documentElement, btn=document.getElementById('themeToggle');
    const stored=localStorage.getItem('theme');
    if(stored==='dark') root.classList.add('dark');
    btn.textContent=root.classList.contains('dark')?'â˜€ï¸':'ğŸŒ™';
    btn.addEventListener('click',()=>{
      root.classList.toggle('dark');
      const dark=root.classList.contains('dark');
      btn.textContent=dark?'â˜€ï¸':'ğŸŒ™';
      localStorage.setItem('theme',dark?'dark':'light');
    });
  }

  window.onload=()=>{
    setupTheme(); setupToggles(); loadPresets();

    // âœ… Tá»± Ä‘á»™ng áº©n 0 khi focus, tráº£ láº¡i 0 náº¿u trá»‘ng
    document.querySelectorAll('#input-section input[type="number"]').forEach(inp=>{
      inp.addEventListener('focus',()=>{ if(inp.value==='0') inp.value=''; });
      inp.addEventListener('blur',()=>{ if(inp.value.trim()==='') inp.value='0'; });
    });

    document.querySelectorAll('#input-section input').forEach(i=>{
      i.addEventListener('input',()=>{
        clearTimeout(debounceTimer);
        debounceTimer=setTimeout(calcSalary,150);
      });
    });
    document.getElementById('save_preset_btn').onclick=savePreset;
    document.getElementById('load_preset_btn').onclick=loadPresetData;
    document.getElementById('delete_preset_btn').onclick=deletePreset;
    document.getElementById('preset_select').onchange=loadPresets;
    calcSalary();
  };
</script>
</body>
</html>
